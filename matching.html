<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Matching - WeBond</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        .glass-nav {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        .btn-primary {
            background: linear-gradient(135deg, #f97316, #ea580c);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(249, 115, 22, 0.3);
        }
        .matching-score {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 600;
        }
        .confidence-bar {
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #ef4444, #f59e0b, #10b981);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        #map {
            height: 400px;
            border-radius: 12px;
        }
        .filter-chip {
            padding: 0.5rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 9999px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .filter-chip.active {
            border-color: #f97316;
            background-color: #fef3c7;
            color: #92400e;
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <!-- Navigation -->
    <nav class="glass-nav fixed top-0 left-0 right-0 z-50 px-6 py-4">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-emerald-500 rounded-lg flex items-center justify-center">
                    <span class="text-white font-bold text-lg">W</span>
                </div>
                <span class="text-white font-bold text-xl">WeBond</span>
            </div>
            <div class="flex items-center space-x-8">
                <a href="index.html" class="text-white hover:text-orange-300 transition-colors">Home</a>
                <a href="dashboard.html" class="text-white hover:text-orange-300 transition-colors">Dashboard</a>
                <a href="community.html" class="text-white hover:text-orange-300 transition-colors">Community</a>
                <div class="w-8 h-8 bg-gray-300 rounded-full"></div>
            </div>
        </div>
    </nav>

    <div class="pt-20 p-6">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">AI-Powered Matching</h1>
                <p class="text-gray-600">Find the perfect local helper based on your needs and preferences</p>
            </div>

            <!-- AI Status -->
            <div class="bg-gradient-to-r from-blue-600 to-emerald-600 text-white rounded-xl p-6 mb-8">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-xl font-bold mb-2">AI Matching Engine Active</h3>
                        <p class="text-blue-100">Analyzing 247 potential helpers in your area...</p>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold pulse-animation">94%</div>
                        <div class="text-sm text-blue-100">Match Confidence</div>
                    </div>
                </div>
            </div>

            <!-- Filters and Map -->
            <div class="grid lg:grid-cols-3 gap-8 mb-8">
                <!-- Filters -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">Filter Helpers</h3>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-3">Skills & Expertise</label>
                                <div class="space-y-2">
                                    <div class="filter-chip" data-filter="cantonese">
                                        <span class="text-sm">Cantonese Language</span>
                                    </div>
                                    <div class="filter-chip" data-filter="local-guide">
                                        <span class="text-sm">Local Guide</span>
                                    </div>
                                    <div class="filter-chip" data-filter="university">
                                        <span class="text-sm">University Tours</span>
                                    </div>
                                    <div class="filter-chip" data-filter="shopping">
                                        <span class="text-sm">Shopping Assistant</span>
                                    </div>
                                    <div class="filter-chip" data-filter="food">
                                        <span class="text-sm">Food Tours</span>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-3">Availability</label>
                                <select id="availability-filter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="">Any time</option>
                                    <option value="now">Available now</option>
                                    <option value="today">Available today</option>
                                    <option value="weekend">Weekend only</option>
                                    <option value="weekday">Weekdays only</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-3">Distance Range</label>
                                <input type="range" id="distance-range" min="0.5" max="10" step="0.5" value="5" class="w-full">
                                <div class="flex justify-between text-sm text-gray-600 mt-1">
                                    <span>0.5km</span>
                                    <span id="distance-value">5km</span>
                                    <span>10km</span>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-3">Minimum Rating</label>
                                <select id="rating-filter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="">Any rating</option>
                                    <option value="4.5">4.5+ stars</option>
                                    <option value="4.0">4.0+ stars</option>
                                    <option value="3.5">3.5+ stars</option>
                                </select>
                            </div>

                            <button onclick="applyFilters()" class="w-full btn-primary text-white py-3 rounded-lg font-medium">
                                Apply Filters
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Map -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">Available Helpers Nearby</h3>
                        <div id="map"></div>
                        <div class="mt-4 text-sm text-gray-600">
                            <p>üìç Showing helpers within 5km of your location</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Matching Results -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-bold text-gray-900">Top Matches for You</h3>
                    <div class="flex items-center space-x-4">
                        <span class="text-sm text-gray-600">Sort by:</span>
                        <select id="sort-by" class="px-3 py-1 border border-gray-300 rounded-lg text-sm">
                            <option value="match">Match Score</option>
                            <option value="rating">Rating</option>
                            <option value="distance">Distance</option>
                            <option value="price">Price</option>
                        </select>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="matches-container">
                    <!-- Matches will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script src="main.js"></script>
    <script>
        let map;
        let userLocation = [22.3193, 114.1694]; // Hong Kong coordinates
        let markers = [];

        document.addEventListener('DOMContentLoaded', function() {
            initializeMap();
            initializeFilters();
            loadMatches();
        });

        function initializeMap() {
            map = L.map('map').setView(userLocation, 13);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);

            // Add user location marker
            L.marker(userLocation)
                .addTo(map)
                .bindPopup('Your Location')
                .openPopup();

            // Add helper markers
            const helpers = [
                { name: 'David Wong', lat: 22.3095, lng: 114.1634, skills: ['Cantonese', 'Local Guide'] },
                { name: 'Lisa Chan', lat: 22.3287, lng: 114.1747, skills: ['Shopping', 'Food Tours'] },
                { name: 'Kevin Liu', lat: 22.3156, lng: 114.1823, skills: ['University Tours', 'Academic Help'] },
                { name: 'Sarah Chen', lat: 22.3041, lng: 114.1756, skills: ['Cultural Exchange', 'Language'] },
                { name: 'Michael Wu', lat: 22.3234, lng: 114.1689, skills: ['Emergency Support', 'Local Guide'] }
            ];

            helpers.forEach(helper => {
                const marker = L.marker([helper.lat, helper.lng])
                    .addTo(map)
                    .bindPopup(`
                        <div class="text-center">
                            <h4 class="font-bold">${helper.name}</h4>
                            <p class="text-sm text-gray-600">${helper.skills.join(', ')}</p>
                            <button onclick="connectWithHelper('${helper.name}')" class="mt-2 bg-blue-600 text-white px-3 py-1 rounded text-sm">Connect</button>
                        </div>
                    `);
                markers.push(marker);
            });
        }

        function initializeFilters() {
            // Filter chips
            const filterChips = document.querySelectorAll('.filter-chip');
            filterChips.forEach(chip => {
                chip.addEventListener('click', function() {
                    this.classList.toggle('active');
                });
            });

            // Distance range
            const distanceRange = document.getElementById('distance-range');
            const distanceValue = document.getElementById('distance-value');
            
            distanceRange.addEventListener('input', function() {
                distanceValue.textContent = this.value + 'km';
            });
        }

        function loadMatches() {
            const matchesContainer = document.getElementById('matches-container');
            const mockMatches = [
                {
                    id: 1,
                    name: 'David Wong',
                    rating: 4.8,
                    reviews: 127,
                    distance: '0.5 km',
                    price: 'HK$150/hour',
                    matchScore: 94,
                    skills: ['Cantonese Language', 'Local Guide', 'University Tours'],
                    languages: ['Cantonese', 'English', 'Mandarin'],
                    availability: 'Available now',
                    image: 'https://kimi-web-img.moonshot.cn/img/cdn.i-scmp.com/eca71b65fbcf675ccc0d80333e5dd911d975aaf0.jpg',
                    bio: 'Local Hong Kong resident with 5+ years experience helping international students. Specializes in cultural integration and language support.'
                },
                {
                    id: 2,
                    name: 'Lisa Chan',
                    rating: 4.9,
                    reviews: 89,
                    distance: '1.2 km',
                    price: 'HK$180/hour',
                    matchScore: 91,
                    skills: ['Shopping Guide', 'Food Tours', 'Cultural Exchange'],
                    languages: ['Cantonese', 'English', 'Japanese'],
                    availability: 'Available today',
                    image: 'https://kimi-web-img.moonshot.cn/img/www.cambridgenetwork.com/f2b8238c91d4e1251e40ec2cc41d45f42f211128.jpg',
                    bio: 'Passionate about sharing Hong Kong culture and cuisine. Fluent in multiple languages with extensive local knowledge.'
                },
                {
                    id: 3,
                    name: 'Kevin Liu',
                    rating: 4.7,
                    reviews: 156,
                    distance: '2.1 km',
                    price: 'HK$120/hour',
                    matchScore: 87,
                    skills: ['Academic Support', 'University Tours', 'Study Groups'],
                    languages: ['Cantonese', 'English', 'Mandarin'],
                    availability: 'Weekends only',
                    image: 'https://kimi-web-img.moonshot.cn/img/zolimacitymag.com/ac757feea915fa451f9644257e4842c515685581.webp',
                    bio: 'University graduate with strong academic background. Experienced tutor and campus guide for international students.'
                }
            ];

            matchesContainer.innerHTML = mockMatches.map(match => `
                <div class="border border-gray-200 rounded-xl p-6 card-hover">
                    <div class="flex items-start space-x-4 mb-4">
                        <img src="${match.image}" alt="${match.name}" class="w-16 h-16 rounded-full object-cover">
                        <div class="flex-1">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-bold text-lg text-gray-900">${match.name}</h4>
                                <div class="matching-score">${match.matchScore}%</div>
                            </div>
                            <div class="flex items-center space-x-4 text-sm text-gray-600 mb-2">
                                <div class="flex items-center">
                                    <svg class="w-4 h-4 text-yellow-400 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                    </svg>
                                    <span>${match.rating}</span>
                                    <span class="text-gray-400">(${match.reviews} reviews)</span>
                                </div>
                                <span>‚Ä¢</span>
                                <span>${match.distance}</span>
                                <span>‚Ä¢</span>
                                <span class="font-medium text-emerald-600">${match.price}</span>
                            </div>
                            <div class="confidence-bar mb-3">
                                <div class="confidence-fill" style="width: ${match.matchScore}%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5 class="font-medium text-gray-900 mb-2">Skills & Expertise</h5>
                        <div class="flex flex-wrap gap-2">
                            ${match.skills.map(skill => `
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-lg text-xs font-medium">${skill}</span>
                            `).join('')}
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5 class="font-medium text-gray-900 mb-2">Languages</h5>
                        <div class="flex flex-wrap gap-2">
                            ${match.languages.map(lang => `
                                <span class="px-2 py-1 bg-emerald-100 text-emerald-800 rounded-lg text-xs font-medium">${lang}</span>
                            `).join('')}
                        </div>
                    </div>

                    <div class="mb-4">
                        <p class="text-sm text-gray-600 leading-relaxed">${match.bio}</p>
                    </div>

                    <div class="flex items-center justify-between">
                        <div class="text-sm">
                            <span class="font-medium text-gray-900">Availability:</span>
                            <span class="text-emerald-600 font-medium">${match.availability}</span>
                        </div>
                        <button onclick="connectWithHelper('${match.name}')" class="btn-primary text-white px-6 py-2 rounded-lg font-medium">
                            Connect Now
                        </button>
                    </div>
                </div>
            `).join('');

            // Animate match cards
            const matchCards = document.querySelectorAll('#matches-container .card-hover');
            matchCards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                
                anime({
                    targets: card,
                    opacity: [0, 1],
                    translateY: [30, 0],
                    duration: 600,
                    delay: index * 200,
                    easing: 'easeOutCubic'
                });
            });
        }

        function applyFilters() {
            const activeFilters = Array.from(document.querySelectorAll('.filter-chip.active'))
                .map(chip => chip.dataset.filter);
            
            const availability = document.getElementById('availability-filter').value;
            const distance = document.getElementById('distance-range').value;
            const rating = document.getElementById('rating-filter').value;

            // Simulate filter application
            console.log('Applying filters:', { activeFilters, availability, distance, rating });
            
            // Show loading animation
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Filtering...';
            button.disabled = true;

            setTimeout(() => {
                loadMatches(); // Reload matches with filters
                button.textContent = originalText;
                button.disabled = false;
            }, 1500);
        }

        function connectWithHelper(helperName) {
            // Simulate connection request
            anime({
                targets: event.target,
                scale: [1, 0.95, 1],
                duration: 200,
                complete: function() {
                    alert(`Connection request sent to ${helperName}! They will be notified and can accept your request.`);
                }
            });
        }
    </script>
</body>
</html>